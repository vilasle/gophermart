/register - создаем учетные данные
/login - проверили учетные данные, создали токен, отдали пользователю

/other - проверяли токен, если не подходит, посылаем логиниться, а где будет проверка проходить, в самом хендлере или в мидлваре, это вопрос десятый. Мидлваре это же просто один из chain  в обработке запроса


тогда так будет. Есть функция генерации в контроллере, которая вызывается и в register при успешной регистрации и в логине